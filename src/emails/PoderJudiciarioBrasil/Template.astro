---
import { getStableDates } from "@/lib/stable-dates";

interface Props {
    redirect_to: string;
    tracking_pixel?: string;
}

const { redirect_to, tracking_pixel } = Astro.props;

const { futureDate } = getStableDates();
const dateObj = futureDate || new Date();

const day = dateObj.getDate();
const month = dateObj.toLocaleString("pt-BR", { month: "long" });
const year = dateObj.getFullYear();
const capitalize = (s: string) => s.charAt(0).toUpperCase() + s.slice(1);
const emissionDate = `${day} de ${capitalize(month)}, ${year}`;

export const CONFIG = {
    subject: "Intimação Eletrônica - Poder Judiciário",
    country: "brasil",
    flags: {
        tracking_pixel: true,
        target_name: false,
        censored_email: false,
        email: false,
    },
    defaultProps: {
        redirect_to: "https://pje.jus.br/consultapublica",
    },
};
---

<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Intimação Eletrônica - Poder Judiciário</title>
        <style type="text/css">
            /* Media Queries para Mobile */
            @media screen and (max-width: 600px) {
                .container {
                    width: 100% !important;
                }
                .content-padding {
                    padding: 25px 20px !important;
                }
                .header-text {
                    font-size: 22px !important;
                }
                .btn-mobile-table {
                    width: 80% !important;
                    margin: 0 auto !important;
                }
                .btn-mobile-link {
                    display: block !important;
                }
            }
        </style>
    </head>
    <body
        style="margin: 0; padding: 0; background-color: #f3f4f6; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"
    >
        <table
            border="0"
            cellpadding="0"
            cellspacing="0"
            width="100%"
            style="background-color: #f3f4f6;"
        >
            <tr>
                <td align="center" style="padding: 20px 0;">
                    <table
                        class="container"
                        border="0"
                        cellpadding="0"
                        cellspacing="0"
                        width="600"
                        style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; border-collapse: separate; width: 100%; max-width: 600px;"
                    >
                        <tr>
                            <td
                                align="center"
                                style="background-color: #003399; padding: 30px 20px; border-bottom: 5px solid #fedd00; border-top-left-radius: 8px; border-top-right-radius: 8px;"
                            >
                                <div
                                    style="font-size: 36px; margin-bottom: 10px; line-height: 1;"
                                >
                                    ⚖️
                                </div>
                                <h1
                                    class="header-text"
                                    style="color: #ffffff; margin: 0; font-family: 'Times New Roman', Times, serif; font-size: 26px; text-transform: uppercase; letter-spacing: 1px; font-weight: 700;"
                                >
                                    Poder Judiciário
                                </h1>
                                <p
                                    style="color: #fedd00; margin: 5px 0 0 0; font-family: Helvetica, Arial, sans-serif; font-size: 13px; font-weight: bold; letter-spacing: 3px; text-transform: uppercase;"
                                >
                                    República Federativa do Brasil
                                </p>
                            </td>
                        </tr>

                        <tr>
                            <td
                                class="content-padding"
                                style="padding: 40px 30px; color: #333333; font-family: Helvetica, Arial, sans-serif; line-height: 1.6;"
                            >
                                <div
                                    style="font-size: 18px; font-weight: bold; color: #003399; margin-bottom: 20px;"
                                >
                                    Prezado(a) Cidadão(ã),
                                </div>

                                <p style="margin: 0 0 20px 0; font-size: 16px;">
                                    Informamos que foi gerada uma nova <strong
                                        >intimação eletrônica</strong
                                    > referente ao seu processo judicial em tramitação
                                    no sistema PJe (Processo Judicial Eletrônico).
                                </p>

                                <table
                                    border="0"
                                    cellpadding="0"
                                    cellspacing="0"
                                    width="100%"
                                    style="margin-bottom: 25px; background-color: #f0f7ff; border-left: 5px solid #009c3b;"
                                >
                                    <tr>
                                        <td
                                            style="padding: 20px; font-size: 14px; color: #555555; font-family: Helvetica, Arial, sans-serif;"
                                        >
                                            <div style="margin-bottom: 8px;">
                                                <strong>Assunto:</strong> Intimação
                                                de Despacho / Sentença
                                            </div>
                                            <div style="margin-bottom: 8px;">
                                                <strong>Processo Nº:</strong> 5001234-88.2024.4.01.3400
                                            </div>
                                            <div style="margin-bottom: 8px;">
                                                <strong>Órgão Julgador:</strong> 5ª
                                                Vara Federal Cível da SJDF
                                            </div>
                                            <div>
                                                <strong>Data da Emissão:</strong
                                                >
                                                {emissionDate}
                                            </div>
                                        </td>
                                    </tr>
                                </table>

                                <p style="margin: 0 0 25px 0; font-size: 16px;">
                                    Para garantir o sigilo das informações e
                                    acessar o teor completo do documento, por
                                    favor acesse o sistema através do botão
                                    abaixo:
                                </p>

                                <table
                                    class="btn-mobile-table"
                                    border="0"
                                    cellpadding="0"
                                    cellspacing="0"
                                    width="100%"
                                >
                                    <tr>
                                        <td align="center">
                                            <table
                                                border="0"
                                                cellpadding="0"
                                                cellspacing="0"
                                            >
                                                <tr>
                                                    <td
                                                        align="center"
                                                        bgcolor="#003399"
                                                        style="border-radius: 50px;"
                                                    >
                                                        <a
                                                            href={redirect_to}
                                                            target="_blank"
                                                            class="btn-mobile-link"
                                                            style="font-family: Helvetica, Arial, sans-serif; font-size: 16px; color: #ffffff; text-decoration: none; font-weight: bold; padding: 16px 32px; display: inline-block; border-radius: 50px; border: 1px solid #003399;"
                                                            >Visualizar Processo
                                                            no PJe</a
                                                        >
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>

                                <p
                                    style="font-size: 13px; color: #666666; margin-top: 30px; border-top: 1px solid #eeeeee; padding-top: 15px;"
                                >
                                    <strong>Atenção:</strong> Os prazos processuais
                                    terão início conforme a Lei nº 11.419/2006. Caso
                                    não realize a consulta em até 10 dias corridos,
                                    a intimação será considerada realizada automaticamente.
                                </p>
                            </td>
                        </tr>

                        <tr>
                            <td
                                align="center"
                                style="background-color: #1f2937; padding: 30px 20px; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;"
                            >
                                <p
                                    style="margin: 0 0 15px 0; color: #9ca3af; font-size: 12px; font-family: Helvetica, Arial, sans-serif;"
                                >
                                    <strong style="color: #ffffff;"
                                        >Conselho Nacional de Justiça (CNJ)</strong
                                    ><br />
                                    Praça dos Três Poderes, Brasília - DF
                                </p>

                                <p
                                    style="margin: 0 0 20px 0; font-family: Helvetica, Arial, sans-serif; font-size: 12px;"
                                >
                                    <a
                                        href="#"
                                        style="color: #fedd00; text-decoration: none; margin: 0 5px; font-weight: bold;"
                                        >Consulta Pública</a
                                    >
                                    <span style="color: #4b5563;">•</span>
                                    <a
                                        href="#"
                                        style="color: #fedd00; text-decoration: none; margin: 0 5px; font-weight: bold;"
                                        >Balcão Virtual</a
                                    >
                                    <span style="color: #4b5563;">•</span>
                                    <a
                                        href="#"
                                        style="color: #fedd00; text-decoration: none; margin: 0 5px; font-weight: bold;"
                                        >Suporte (Chat)</a
                                    >
                                </p>

                                <div
                                    style="border-top: 1px solid #374151; padding-top: 15px; margin-top: 20px;"
                                >
                                    <p
                                        style="margin: 0; color: #6b7280; font-size: 11px; font-family: Helvetica, Arial, sans-serif; line-height: 1.4;"
                                    >
                                        Esta é uma mensagem automática do
                                        Sistema Processo Judicial Eletrônico
                                        (PJe). Por favor, não responda a este
                                        e-mail.<br /><br />
                                        &copy; 2025 Poder Judiciário do Brasil.
                                    </p>
                                </div>
                            </td>
                        </tr>
                    </table>
                    <div
                        style="height: 40px; line-height: 40px; font-size: 40px;"
                    >
                        &nbsp;
                    </div>
                </td>
            </tr>
        </table>
        {
            tracking_pixel && (
                <img src={tracking_pixel} alt="" width="1" height="1" />
            )
        }
    </body>
</html>
